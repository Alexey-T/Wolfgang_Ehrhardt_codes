{-Test prog for SHACAL2 basic routines, we 2008}
{ Test vector from crypto++ 5.5.2}

program T_SCBas2;

{$i STD.INC}

{$ifdef APPCONS}
  {$apptype console}
{$endif}

{$ifndef FPC}
  {$N+}
{$endif}

{$i-}

uses
  SC_Base,mem_util;


const
  key01: array[0..15] of byte = ($80,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00);

  pt_01: array[0..31] of byte = ($00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00);

  ct_01: array[0..31] of byte = ($36,$1a,$b6,$32,$2f,$a9,$e7,$a7,
                                 $bb,$23,$81,$8d,$83,$9e,$01,$bd,
                                 $da,$fd,$f4,$73,$05,$42,$6e,$dd,
                                 $29,$7a,$ed,$b9,$f6,$20,$2b,$ae);


  key02: array[0..15] of byte = ($00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$01);

  pt_02: array[0..31] of byte = ($00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00);

  ct_02: array[0..31] of byte = ($73,$08,$ae,$c2,$3d,$25,$a2,$31,
                                 $b2,$64,$48,$af,$e7,$8d,$50,$47,
                                 $80,$4c,$50,$11,$b9,$b5,$f9,$5c,
                                 $16,$df,$26,$70,$55,$1f,$00,$01);


  key03: array[0..15] of byte = ($00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00);

  pt_03: array[0..31] of byte = ($80,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00);

  ct_03: array[0..31] of byte = ($2c,$ae,$7c,$04,$60,$ee,$2f,$c3,
                                 $20,$09,$23,$a1,$b6,$c2,$ab,$ee,
                                 $a7,$46,$c8,$b4,$4f,$6c,$3f,$b9,
                                 $41,$bd,$3a,$f0,$2a,$3e,$6e,$3e);


  key04: array[0..15] of byte = ($00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00);

  pt_04: array[0..31] of byte = ($00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$01);

  ct_04: array[0..31] of byte = ($45,$d4,$3e,$92,$88,$73,$8c,$5a,
                                 $d1,$a6,$83,$d8,$de,$59,$ce,$dd,
                                 $22,$d6,$66,$a2,$b7,$07,$8e,$b1,
                                 $30,$1b,$53,$2a,$27,$2d,$57,$0b);


  key05: array[0..63] of byte = ($00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00);

  pt_05: array[0..31] of byte = ($00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00,
                                 $00,$00,$00,$00,$00,$00,$00,$00);

  ct_05: array[0..31] of byte = ($7c,$a5,$16,$14,$42,$5c,$3b,$a8,
                                 $ce,$54,$dd,$2f,$c2,$02,$0a,$e7,
                                 $b6,$e5,$74,$d1,$98,$13,$6d,$0f,
                                 $ae,$7e,$26,$cc,$bf,$0b,$e7,$a6);


  key06: array[0..63] of byte = ($01,$01,$01,$01,$01,$01,$01,$01,
                                 $01,$01,$01,$01,$01,$01,$01,$01,
                                 $01,$01,$01,$01,$01,$01,$01,$01,
                                 $01,$01,$01,$01,$01,$01,$01,$01,
                                 $01,$01,$01,$01,$01,$01,$01,$01,
                                 $01,$01,$01,$01,$01,$01,$01,$01,
                                 $01,$01,$01,$01,$01,$01,$01,$01,
                                 $01,$01,$01,$01,$01,$01,$01,$01);

  pt_06: array[0..31] of byte = ($01,$01,$01,$01,$01,$01,$01,$01,
                                 $01,$01,$01,$01,$01,$01,$01,$01,
                                 $01,$01,$01,$01,$01,$01,$01,$01,
                                 $01,$01,$01,$01,$01,$01,$01,$01);

  ct_06: array[0..31] of byte = ($c4,$b7,$c6,$a9,$73,$8c,$77,$ee,
                                 $28,$f7,$e6,$85,$c8,$35,$8e,$0a,
                                 $f8,$8f,$b6,$d2,$39,$55,$ee,$6d,
                                 $f4,$9f,$e3,$f5,$da,$16,$f8,$26);


  key07: array[0..63] of byte = ($02,$02,$02,$02,$02,$02,$02,$02,
                                 $02,$02,$02,$02,$02,$02,$02,$02,
                                 $02,$02,$02,$02,$02,$02,$02,$02,
                                 $02,$02,$02,$02,$02,$02,$02,$02,
                                 $02,$02,$02,$02,$02,$02,$02,$02,
                                 $02,$02,$02,$02,$02,$02,$02,$02,
                                 $02,$02,$02,$02,$02,$02,$02,$02,
                                 $02,$02,$02,$02,$02,$02,$02,$02);

  pt_07: array[0..31] of byte = ($02,$02,$02,$02,$02,$02,$02,$02,
                                 $02,$02,$02,$02,$02,$02,$02,$02,
                                 $02,$02,$02,$02,$02,$02,$02,$02,
                                 $02,$02,$02,$02,$02,$02,$02,$02);

  ct_07: array[0..31] of byte = ($cd,$10,$8d,$d9,$ec,$10,$00,$b7,
                                 $9c,$75,$aa,$3d,$cc,$88,$f9,$13,
                                 $e6,$f5,$27,$73,$85,$30,$35,$a5,
                                 $c4,$4f,$32,$45,$b1,$34,$cb,$ff);


  key08: array[0..63] of byte = ($04,$04,$04,$04,$04,$04,$04,$04,
                                 $04,$04,$04,$04,$04,$04,$04,$04,
                                 $04,$04,$04,$04,$04,$04,$04,$04,
                                 $04,$04,$04,$04,$04,$04,$04,$04,
                                 $04,$04,$04,$04,$04,$04,$04,$04,
                                 $04,$04,$04,$04,$04,$04,$04,$04,
                                 $04,$04,$04,$04,$04,$04,$04,$04,
                                 $04,$04,$04,$04,$04,$04,$04,$04);

  pt_08: array[0..31] of byte = ($04,$04,$04,$04,$04,$04,$04,$04,
                                 $04,$04,$04,$04,$04,$04,$04,$04,
                                 $04,$04,$04,$04,$04,$04,$04,$04,
                                 $04,$04,$04,$04,$04,$04,$04,$04);

  ct_08: array[0..31] of byte = ($6a,$a7,$77,$34,$02,$00,$c1,$b6,
                                 $5a,$b2,$51,$93,$a8,$bb,$26,$7c,
                                 $23,$3d,$ac,$7e,$1b,$3c,$52,$3d,
                                 $40,$6f,$c5,$b5,$67,$b7,$b5,$86);


  key09: array[0..63] of byte = ($08,$08,$08,$08,$08,$08,$08,$08,
                                 $08,$08,$08,$08,$08,$08,$08,$08,
                                 $08,$08,$08,$08,$08,$08,$08,$08,
                                 $08,$08,$08,$08,$08,$08,$08,$08,
                                 $08,$08,$08,$08,$08,$08,$08,$08,
                                 $08,$08,$08,$08,$08,$08,$08,$08,
                                 $08,$08,$08,$08,$08,$08,$08,$08,
                                 $08,$08,$08,$08,$08,$08,$08,$08);

  pt_09: array[0..31] of byte = ($08,$08,$08,$08,$08,$08,$08,$08,
                                 $08,$08,$08,$08,$08,$08,$08,$08,
                                 $08,$08,$08,$08,$08,$08,$08,$08,
                                 $08,$08,$08,$08,$08,$08,$08,$08);

  ct_09: array[0..31] of byte = ($a2,$3b,$e3,$2d,$37,$fa,$40,$54,
                                 $ec,$45,$d6,$a9,$cc,$64,$3a,$f9,
                                 $12,$4e,$da,$a4,$ad,$9a,$bc,$7f,
                                 $aa,$b4,$49,$d3,$9d,$11,$b1,$28);


  key10: array[0..63] of byte = ($10,$10,$10,$10,$10,$10,$10,$10,
                                 $10,$10,$10,$10,$10,$10,$10,$10,
                                 $10,$10,$10,$10,$10,$10,$10,$10,
                                 $10,$10,$10,$10,$10,$10,$10,$10,
                                 $10,$10,$10,$10,$10,$10,$10,$10,
                                 $10,$10,$10,$10,$10,$10,$10,$10,
                                 $10,$10,$10,$10,$10,$10,$10,$10,
                                 $10,$10,$10,$10,$10,$10,$10,$10);

  pt_10: array[0..31] of byte = ($10,$10,$10,$10,$10,$10,$10,$10,
                                 $10,$10,$10,$10,$10,$10,$10,$10,
                                 $10,$10,$10,$10,$10,$10,$10,$10,
                                 $10,$10,$10,$10,$10,$10,$10,$10);

  ct_10: array[0..31] of byte = ($f6,$48,$19,$df,$be,$be,$0a,$6d,
                                 $b6,$50,$e7,$07,$2c,$e2,$8e,$a6,
                                 $06,$58,$64,$18,$b3,$17,$78,$5f,
                                 $f0,$ad,$44,$21,$2a,$84,$c8,$2c);


  key11: array[0..63] of byte = ($20,$20,$20,$20,$20,$20,$20,$20,
                                 $20,$20,$20,$20,$20,$20,$20,$20,
                                 $20,$20,$20,$20,$20,$20,$20,$20,
                                 $20,$20,$20,$20,$20,$20,$20,$20,
                                 $20,$20,$20,$20,$20,$20,$20,$20,
                                 $20,$20,$20,$20,$20,$20,$20,$20,
                                 $20,$20,$20,$20,$20,$20,$20,$20,
                                 $20,$20,$20,$20,$20,$20,$20,$20);

  pt_11: array[0..31] of byte = ($20,$20,$20,$20,$20,$20,$20,$20,
                                 $20,$20,$20,$20,$20,$20,$20,$20,
                                 $20,$20,$20,$20,$20,$20,$20,$20,
                                 $20,$20,$20,$20,$20,$20,$20,$20);

  ct_11: array[0..31] of byte = ($e2,$67,$d6,$11,$3c,$27,$17,$0a,
                                 $3e,$e6,$df,$49,$6e,$80,$1a,$61,
                                 $31,$bb,$d3,$44,$43,$65,$d7,$c0,
                                 $37,$91,$e2,$56,$10,$f1,$a0,$e4);


  key12: array[0..63] of byte = ($40,$40,$40,$40,$40,$40,$40,$40,
                                 $40,$40,$40,$40,$40,$40,$40,$40,
                                 $40,$40,$40,$40,$40,$40,$40,$40,
                                 $40,$40,$40,$40,$40,$40,$40,$40,
                                 $40,$40,$40,$40,$40,$40,$40,$40,
                                 $40,$40,$40,$40,$40,$40,$40,$40,
                                 $40,$40,$40,$40,$40,$40,$40,$40,
                                 $40,$40,$40,$40,$40,$40,$40,$40);

  pt_12: array[0..31] of byte = ($40,$40,$40,$40,$40,$40,$40,$40,
                                 $40,$40,$40,$40,$40,$40,$40,$40,
                                 $40,$40,$40,$40,$40,$40,$40,$40,
                                 $40,$40,$40,$40,$40,$40,$40,$40);

  ct_12: array[0..31] of byte = ($c9,$79,$09,$91,$6e,$e8,$6f,$fd,
                                 $ce,$8a,$92,$90,$30,$46,$10,$9b,
                                 $53,$f7,$88,$a5,$30,$39,$43,$4d,
                                 $f1,$a3,$94,$da,$d6,$f6,$97,$a2);


  key13: array[0..63] of byte = ($80,$80,$80,$80,$80,$80,$80,$80,
                                 $80,$80,$80,$80,$80,$80,$80,$80,
                                 $80,$80,$80,$80,$80,$80,$80,$80,
                                 $80,$80,$80,$80,$80,$80,$80,$80,
                                 $80,$80,$80,$80,$80,$80,$80,$80,
                                 $80,$80,$80,$80,$80,$80,$80,$80,
                                 $80,$80,$80,$80,$80,$80,$80,$80,
                                 $80,$80,$80,$80,$80,$80,$80,$80);

  pt_13: array[0..31] of byte = ($80,$80,$80,$80,$80,$80,$80,$80,
                                 $80,$80,$80,$80,$80,$80,$80,$80,
                                 $80,$80,$80,$80,$80,$80,$80,$80,
                                 $80,$80,$80,$80,$80,$80,$80,$80);

  ct_13: array[0..31] of byte = ($c3,$c1,$cd,$5f,$30,$60,$b3,$ec,
                                 $4e,$6a,$bc,$08,$18,$b6,$84,$49,
                                 $e1,$75,$0f,$b4,$82,$36,$8c,$8f,
                                 $33,$05,$27,$0e,$16,$f9,$87,$35);


  key14: array[0..63] of byte = ($ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff,
                                 $ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff,
                                 $ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff,
                                 $ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff,
                                 $ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff,
                                 $ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff,
                                 $ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff,
                                 $ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff);

  pt_14: array[0..31] of byte = ($ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff,
                                 $ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff,
                                 $ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff,
                                 $ff,$ff,$ff,$ff,$ff,$ff,$ff,$ff);

  ct_14: array[0..31] of byte = ($05,$98,$12,$7b,$af,$11,$70,$6f,
                                 $77,$40,$20,$00,$d7,$30,$c5,$4a,
                                 $0b,$84,$c8,$68,$a9,$8c,$6c,$a4,
                                 $d7,$f3,$c0,$fa,$06,$a7,$8b,$7a);




procedure OneTest(Nr: integer; pk: pointer; lk: integer; pt,ct: TSCBlock);
var
  ctx: TSCContext;
  tmp: TSCBlock;
begin
  write(' Test Nr ', Nr:2, ':  ');
  if SC_Init(pk^, lk, ctx)<>0 then begin
    writeln('SC_Init error');
    exit;
  end;
  SC_Encrypt(ctx, pt, tmp);
  if not CompMem(@ct, @tmp, sizeof(ct)) then begin
    writeln('SC_Encrypt error');
    exit;
  end;
  SC_Decrypt(ctx, ct, tmp);
  if not CompMem(@pt, @tmp, sizeof(pt)) then begin
    writeln('SC_Encrypt error');
  end;
  writeln('OK');
end;

begin
  OneTest( 1, @key01, sizeof(key01), TSCBlock(pt_01), TSCBlock(ct_01));
  OneTest( 2, @key02, sizeof(key02), TSCBlock(pt_02), TSCBlock(ct_02));
  OneTest( 3, @key03, sizeof(key03), TSCBlock(pt_03), TSCBlock(ct_03));
  OneTest( 4, @key04, sizeof(key04), TSCBlock(pt_04), TSCBlock(ct_04));
  OneTest( 5, @key05, sizeof(key05), TSCBlock(pt_05), TSCBlock(ct_05));
  OneTest( 6, @key06, sizeof(key06), TSCBlock(pt_06), TSCBlock(ct_06));
  OneTest( 7, @key07, sizeof(key07), TSCBlock(pt_07), TSCBlock(ct_07));
  OneTest( 8, @key08, sizeof(key08), TSCBlock(pt_08), TSCBlock(ct_08));
  OneTest( 9, @key09, sizeof(key09), TSCBlock(pt_09), TSCBlock(ct_09));
  OneTest(10, @key10, sizeof(key10), TSCBlock(pt_10), TSCBlock(ct_10));
  OneTest(11, @key11, sizeof(key11), TSCBlock(pt_11), TSCBlock(ct_11));
  OneTest(12, @key12, sizeof(key12), TSCBlock(pt_12), TSCBlock(ct_12));
  OneTest(13, @key13, sizeof(key13), TSCBlock(pt_13), TSCBlock(ct_13));
  OneTest(14, @key14, sizeof(key14), TSCBlock(pt_14), TSCBlock(ct_14));
end.
